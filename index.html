<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>DDC Menu</title>
<link rel="icon" type="image/png" href="ddc-favi-con.png">

<style>
  :root { --gap:18px; --panel-radius:12px; --transition:280ms; }

  /* theme variables (applied via data-theme on body) */
  body[data-theme="dark"]{
    --bg: #0f0f11;
    --fg: #f3f3f3;
    --panel: rgba(255,255,255,0.07);
    --panel-hover: rgba(255,255,255,0.18);
    --shadow: rgba(0,0,0,0.55);
  }
  body[data-theme="light"]{
    --bg: #f6f7f8;
    --fg: #0f1112;
    --panel: rgba(0,0,0,0.06);
    --panel-hover: rgba(0,0,0,0.14);
    --shadow: rgba(0,0,0,0.12);
  }

  html,body{height:100%;margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial;}
  body{background:var(--bg);color:var(--fg);display:flex;align-items:center;justify-content:center;overflow:hidden;}

  /* main viewport & carousel */
  .viewport{
    width:100vw;height:100vh;display:flex;align-items:center;justify-content:center;position:relative;touch-action:none;
  }
  .carousel{
    width:min(95vw,1200px);height:min(95vh,1600px);overflow:hidden;border-radius:10px;position:relative;
  }
  .track{display:flex;width:100%;height:100%;transition:transform 420ms cubic-bezier(.22,.9,.26,1);will-change:transform;}
  .slide{min-width:100%;height:100%;display:flex;align-items:center;justify-content:center;}
  .slide img{max-width:100%;max-height:100%;object-fit:contain;border-radius:8px;user-select:none;-webkit-user-drag:none;touch-action:none;transition:transform 160ms ease;}

  /* nav buttons */
  .navBtn{
    position:fixed;top:50%;transform:translateY(-50%);z-index:40;display:inline-flex;align-items:center;justify-content:center;
    background:var(--panel);color:var(--fg);padding:14px 16px;border-radius:14px;font-size:28px;cursor:pointer;
    box-shadow: 0 10px 30px var(--shadow);transition:transform 160ms ease, background 160ms ease;
  }
  .navBtn:hover{ transform: translateY(-50%) scale(1.18); background:var(--panel-hover); }
  .nav-left{ left:16px; } .nav-right{ right:16px; }

  /* controls: bottom-right counter */
  .counter{
    position:fixed;right:18px;bottom:18px;background:var(--panel);color:var(--fg);padding:8px 12px;border-radius:10px;
    font-size:15px;box-shadow:0 8px 24px var(--shadow);transition:background 160ms ease;
  }
  .counter:hover{ background:var(--panel-hover); transform: translateY(-1px); }

  /* corner controls */
  .corner{
    position:fixed;top:12px;left:12px;display:flex;gap:10px;z-index:50;
  }
  .corner .control{
    background:var(--panel);color:var(--fg);padding:8px 10px;border-radius:10px;font-size:16px;cursor:pointer;
    box-shadow:0 8px 20px var(--shadow);transition:transform 140ms ease, background 140ms ease;
  }
  .corner .control:hover{ transform: scale(1.12); background:var(--panel-hover); }

  .corner.right{ left:auto; right:12px; }

  /* zoom grouping */
  .zoom-label{ padding:6px 8px; font-size:14px; }

  /* mobile adjustments */
  @media (max-width:640px){
    .navBtn{ padding:16px 18px; font-size:26px; }
    .corner .control{ padding:10px 12px; font-size:18px; }
    .counter{ right:12px; bottom:12px; font-size:16px; padding:10px 14px; }
  }

  /* focus style */
  .navBtn:focus, .control:focus{ outline:2px solid rgba(255,255,255,0.06); outline-offset:3px; }
</style>
</head>
<body>

  <div class="viewport" id="viewport">
    <div class="carousel" id="carousel">
      <div class="track" id="track">
        <div class="slide"><img id="img-0" src="ddc.png" alt="page 1"></div>
        <div class="slide"><img id="img-1" src="ddc2.png" alt="page 2"></div>
        <div class="slide"><img id="img-2" src="ddc3.png" alt="page 3"></div>
      </div>
    </div>
  </div>

  <!-- arrows -->
  <div class="navBtn nav-left" id="prevBtn" title="Previous (←)">‹</div>
  <div class="navBtn nav-right" id="nextBtn" title="Next (→)">›</div>

  <!-- counter -->
  <div class="counter" id="counter">1 / 3</div>

  <!-- zoom (top-left) -->
  <div class="corner" id="cornerLeft">
    <div class="control" id="zoomOut" title="Zoom out">−</div>
    <div class="control zoom-label" id="zoomLabel">100%</div>
    <div class="control" id="zoomIn" title="Zoom in">＋</div>
    <div class="control" id="zoomReset" title="Reset">⟳</div>
  </div>

  <!-- theme toggle (top-right) -->
  <div class="corner right" id="cornerRight">
    <div class="control" id="themeToggle" title="Toggle light/dark">☾</div>
  </div>

<script>
/* ===== configuration & state ===== */
const pages = ['ddc.png','ddc2.png','ddc3.png'];
let index = 0;

const zoomSteps = [1, 1.25, 1.5, 1.75, 2];
let zoomIndex = 0;
let zoom = zoomSteps[zoomIndex];
let panX = 0, panY = 0;
let panning = false;
let panStart = {x:0,y:0};
let pointerId = null;

/* DOM refs */
let track, viewport, imgs, counter, prevBtn, nextBtn, zoomIn, zoomOut, zoomLabel, zoomReset, themeToggle;

function $(id){ return document.getElementById(id); }

/* ===== theme handling ===== */
function loadTheme(){
  const t = localStorage.getItem('ddc-theme') || 'dark';
  document.body.setAttribute('data-theme', t);
  themeToggle.textContent = t === 'dark' ? '☾' : '☼';
}
function toggleTheme(){
  const now = document.body.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
  document.body.setAttribute('data-theme', now);
  localStorage.setItem('ddc-theme', now);
  themeToggle.textContent = now === 'dark' ? '☾' : '☼';
}

/* ===== carousel & UI updates ===== */
function updateTrack(animate=true){
  track.style.transition = animate ? 'transform 420ms cubic-bezier(.22,.9,.26,1)' : 'none';
  track.style.transform = `translateX(${-index*100}%)`;
  counter.textContent = `${index+1} / ${pages.length}`;
  resetPanIfNeeded();
}

function resetPanIfNeeded(){
  if(zoom === 1){
    panX = 0; panY = 0;
    imgs.forEach(img => img.style.transform = `translate(0px,0px) scale(1)`);
  } else {
    // ensure current image uses current pan/zoom
    imgs.forEach((img, i) => {
      if(i === index) img.style.transform = `translate(${panX}px, ${panY}px) scale(${zoom})`;
      else img.style.transform = `translate(0px, 0px) scale(${zoom})`;
    });
  }
}

/* ===== zoom handling ===== */
function applyZoom(){
  zoom = zoomSteps[zoomIndex] || 1;
  zoomLabel.textContent = `${Math.round(zoom*100)}%`;
  imgs.forEach((img,i)=>{
    // when switching slides, non-current images keep scale but are centered
    if(i === index){
      img.style.transform = `translate(${panX}px, ${panY}px) scale(${zoom})`;
    } else {
      img.style.transform = `translate(0px,0px) scale(${zoom})`;
    }
  });
  // if zoom reset to 1, clear pan
  if(zoom === 1){ panX=0; panY=0; }
}

/* ===== navigation helpers ===== */
function prevPage(){
  if(zoom === 1){
    index = (index - 1 + pages.length) % pages.length;
    updateTrack(true);
  } else {
    // small jump reset pan
    panX = 0; panY = 0; updateTrack(true);
  }
}
function nextPage(){
  if(zoom === 1){
    index = (index + 1) % pages.length;
    updateTrack(true);
  } else {
    panX = 0; panY = 0; updateTrack(true);
  }
}

/* ===== pointer panning ===== */
function onPointerDown(e){
  // only start panning if zoomed
  if(zoom <= 1) return;
  panning = true;
  pointerId = e.pointerId;
  panStart = {x: e.clientX - panX, y: e.clientY - panY};
  viewport.setPointerCapture(pointerId);
  viewport.style.cursor = 'grabbing';
}
function onPointerMove(e){
  if(!panning || e.pointerId !== pointerId) return;
  panX = e.clientX - panStart.x;
  panY = e.clientY - panStart.y;
  imgs[index].style.transform = `translate(${panX}px, ${panY}px) scale(${zoom})`;
}
function onPointerUp(e){
  if(!panning || e.pointerId !== pointerId) return;
  panning = false;
  try{ viewport.releasePointerCapture(pointerId); }catch(_){}
  viewport.style.cursor = 'default';
}

/* ===== touch swipe for changing pages when not zoomed ===== */
let touchStart = null;
viewportTouchStart = function(e){
  if(zoom > 1) return;
  const t = e.touches ? e.touches[0] : null;
  if(!t) return;
  touchStart = {x: t.clientX, y: t.clientY, t: Date.now()};
};
viewportTouchEnd = function(e){
  if(!touchStart) return;
  const t = (e.changedTouches && e.changedTouches[0]) || null;
  const endX = t ? t.clientX : touchStart.x;
  const endY = t ? t.clientY : touchStart.y;
  const dx = endX - touchStart.x, dy = endY - touchStart.y;
  if(Math.abs(dx) > Math.abs(dy) && Math.abs(dx) > 50){
    if(dx < 0) nextPage(); else prevPage();
  } else if(Math.abs(dy) > Math.abs(dx) && Math.abs(dy) > 50){
    if(dy < 0) nextPage(); else prevPage();
  }
  touchStart = null;
};

/* ===== wheel / keyboard behavior ===== */
let wheelBlock = false;
function onWheel(e){
  if(zoom > 1) return; // allow default panning when zoomed
  if(wheelBlock) return;
  if(Math.abs(e.deltaY) > Math.abs(e.deltaX)){
    if(e.deltaY > 0) nextPage(); else prevPage();
    wheelBlock = true;
    setTimeout(()=> wheelBlock = false, 300);
  }
}
function onKeydown(e){
  if(e.key === 'ArrowLeft') prevPage();
  if(e.key === 'ArrowRight') nextPage();
  if(e.key === '+' || e.key === '=') { zoomIn.click(); }
  if(e.key === '-') zoomOut.click();
  if(e.key === ' ') { e.preventDefault(); if(zoom === 1) { zoomIndex = 2; } else zoomIndex = 0; applyZoom(); }
}

/* ===== init and wiring ===== */
document.addEventListener('DOMContentLoaded', ()=>{
  // refs
  track = $('track'); viewport = $('viewport'); imgs = pages.map((_,i)=>$('img-'+i));
  counter = $('counter'); prevBtn = $('prevBtn'); nextBtn = $('nextBtn');
  zoomIn = $('zoomIn'); zoomOut = $('zoomOut'); zoomLabel = $('zoomLabel'); zoomReset = $('zoomReset');
  themeToggle = $('themeToggle');

  loadTheme(); // uses themeToggle too
  updateTrack(false);
  applyZoom();

  // listeners
  prevBtn.addEventListener('click', prevPage);
  nextBtn.addEventListener('click', nextPage);

  zoomIn.addEventListener('click', ()=>{ if(zoomIndex < zoomSteps.length-1) zoomIndex++; applyZoom(); });
  zoomOut.addEventListener('click', ()=>{ if(zoomIndex > 0) zoomIndex--; applyZoom(); });
  zoomReset.addEventListener('click', ()=>{ zoomIndex = 0; panX = 0; panY = 0; applyZoom(); });

  // pointer panning (works for mouse and touch via pointer events)
  viewport.addEventListener('pointerdown', onPointerDown);
  viewport.addEventListener('pointermove', onPointerMove);
  viewport.addEventListener('pointerup', onPointerUp);
  viewport.addEventListener('pointercancel', onPointerUp);

  // touch swipe fallback for mobile
  viewport.addEventListener('touchstart', viewportTouchStart, {passive:true});
  viewport.addEventListener('touchend', viewportTouchEnd, {passive:true});

  // wheel & keys
  window.addEventListener('wheel', onWheel, {passive:true});
  window.addEventListener('keydown', onKeydown);

  // theme toggle
  themeToggle.addEventListener('click', toggleTheme);

  // initial visibility / ensure image transforms set
  imgs.forEach((img)=>{ img.style.transform = 'translate(0px,0px) scale(1)'; img.addEventListener('dragstart', e=>e.preventDefault()); });
});

/* expose some globals for console debugging (optional) */
window._ddc = { nextPage, prevPage, applyZoom };
</script>
</body>
</html>
